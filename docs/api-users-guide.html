<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>13 API Users’ Guide | Models on the Peer Models Network</title>
  <meta name="description" content="User guide for accessing models hosted on the Peer Models Network cloud." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="13 API Users’ Guide | Models on the Peer Models Network" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="User guide for accessing models hosted on the Peer Models Network cloud." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="13 API Users’ Guide | Models on the Peer Models Network" />
  
  <meta name="twitter:description" content="User guide for accessing models hosted on the Peer Models Network cloud." />
  

<meta name="author" content="Amin Adibi, Stephanie Harvard, Mohsen Sadatsafavi" />


<meta name="date" content="2020-06-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="qrisk3.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PMN User Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="accept.html"><a href="accept.html"><i class="fa fa-check"></i><b>2</b> ACCEPT</a></li>
<li class="chapter" data-level="3" data-path="bode.html"><a href="bode.html"><i class="fa fa-check"></i><b>3</b> BODE</a></li>
<li class="chapter" data-level="4" data-path="cfmortality.html"><a href="cfmortality.html"><i class="fa fa-check"></i><b>4</b> CFMortality</a></li>
<li class="chapter" data-level="5" data-path="chdwilson.html"><a href="chdwilson.html"><i class="fa fa-check"></i><b>5</b> CHDWilson</a></li>
<li class="chapter" data-level="6" data-path="codexcopd.html"><a href="codexcopd.html"><i class="fa fa-check"></i><b>6</b> CODEXCOPD</a></li>
<li class="chapter" data-level="7" data-path="covidseir.html"><a href="covidseir.html"><i class="fa fa-check"></i><b>7</b> COVIDSEIR</a></li>
<li class="chapter" data-level="8" data-path="cvdanderson.html"><a href="cvdanderson.html"><i class="fa fa-check"></i><b>8</b> CVDAnderson</a></li>
<li class="chapter" data-level="9" data-path="epic.html"><a href="epic.html"><i class="fa fa-check"></i><b>9</b> EPIC</a></li>
<li class="chapter" data-level="10" data-path="fev1.html"><a href="fev1.html"><i class="fa fa-check"></i><b>10</b> FEV1</a></li>
<li class="chapter" data-level="11" data-path="mmrcea.html"><a href="mmrcea.html"><i class="fa fa-check"></i><b>11</b> MMRCEA</a></li>
<li class="chapter" data-level="12" data-path="qrisk3.html"><a href="qrisk3.html"><i class="fa fa-check"></i><b>12</b> QRISK3</a></li>
<li class="chapter" data-level="13" data-path="api-users-guide.html"><a href="api-users-guide.html"><i class="fa fa-check"></i><b>13</b> API Users’ Guide</a><ul>
<li class="chapter" data-level="13.1" data-path="accept.html"><a href="accept.html#accept"><i class="fa fa-check"></i><b>13.1</b> ACCEPT</a></li>
<li class="chapter" data-level="13.2" data-path="bode.html"><a href="bode.html#bode"><i class="fa fa-check"></i><b>13.2</b> BODE</a></li>
<li class="chapter" data-level="13.3" data-path="epic.html"><a href="epic.html#epic"><i class="fa fa-check"></i><b>13.3</b> EPIC</a></li>
<li class="chapter" data-level="13.4" data-path="fev1.html"><a href="fev1.html#fev1"><i class="fa fa-check"></i><b>13.4</b> FEV1</a></li>
<li class="chapter" data-level="13.5" data-path="cvdanderson.html"><a href="cvdanderson.html#cvdanderson"><i class="fa fa-check"></i><b>13.5</b> CVDAnderson</a></li>
<li class="chapter" data-level="13.6" data-path="chdwilson.html"><a href="chdwilson.html#chdwilson"><i class="fa fa-check"></i><b>13.6</b> CHDWilson</a></li>
<li class="chapter" data-level="13.7" data-path="cfmortality.html"><a href="cfmortality.html#cfmortality"><i class="fa fa-check"></i><b>13.7</b> CFMortality</a></li>
<li class="chapter" data-level="13.8" data-path="qrisk3.html"><a href="qrisk3.html#qrisk3"><i class="fa fa-check"></i><b>13.8</b> QRISK3</a></li>
<li class="chapter" data-level="13.9" data-path="codexcopd.html"><a href="codexcopd.html#codexcopd"><i class="fa fa-check"></i><b>13.9</b> CODEXCOPD</a></li>
<li class="chapter" data-level="13.10" data-path="mmrcea.html"><a href="mmrcea.html#mmrcea"><i class="fa fa-check"></i><b>13.10</b> MMRCEA</a></li>
<li class="chapter" data-level="13.11" data-path="covidseir.html"><a href="covidseir.html#covidseir"><i class="fa fa-check"></i><b>13.11</b> COVIDSEIR</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.peermodelsnetwork.com" target="blank">Peer Models Network</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Models on the Peer Models Network</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="api-users-guide" class="section level1">
<h1><span class="header-section-number">13</span> API Users’ Guide</h1>
<div id="accept" class="section level2">
<h2><span class="header-section-number">13.1</span> ACCEPT</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patients provided in the <code>accept</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;accept&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Python</strong></p>
<pre><code>import json
import requests
url = &#39;https://prism.peermodelsnetwork.com/route/accept/run&#39;
headers = {&#39;x-prism-auth-user&#39;: YOUR_API_KEY}
model_run = requests.post(url, headers=headers,
json = {&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;ID&quot;: &quot;10001&quot;,&quot;male&quot;: 1,&quot;age&quot;: 57,&quot;smoker&quot;: 0,&quot;oxygen&quot;: 0,&quot;statin&quot;: 0,&quot;LAMA&quot;: 1,&quot;LABA&quot;: 1,&quot;ICS&quot;: 1,&quot;FEV1&quot;: 51,&quot;BMI&quot;: 18,&quot;SGRQ&quot;: 63,&quot;LastYrExacCount&quot;: 2,&quot;LastYrSevExacCount&quot;: 1,&quot;randomized_azithromycin&quot;: 0,&quot;randomized_statin&quot;: 0,&quot;randomized_LAMA&quot;: 0,&quot;randomized_LABA&quot;: 0,&quot;randomized_ICS&quot;: 0, &quot;random_sampling_N&quot; : 1000, &quot;random_distribution_iteration&quot; : 20000, &quot;calculate_CIs&quot; : &quot;TRUE&quot;}]})
print(model_run)
results = json.loads(model_run.text)
print(results)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;ID&quot;: &quot;10001&quot;,&quot;male&quot;: 1,&quot;age&quot;: 57,&quot;smoker&quot;: 0,&quot;oxygen&quot;: 0,&quot;statin&quot;: 0,&quot;LAMA&quot;: 1,&quot;LABA&quot;: 1,&quot;ICS&quot;: 1,&quot;FEV1&quot;: 51,&quot;BMI&quot;: 18,&quot;SGRQ&quot;: 63,&quot;LastYrExacCount&quot;: 2,&quot;LastYrSevExacCount&quot;: 1,&quot;randomized_azithromycin&quot;: 0,&quot;randomized_statin&quot;: 0,&quot;randomized_LAMA&quot;: 0,&quot;randomized_LABA&quot;: 0,&quot;randomized_ICS&quot;: 0, &quot;random_sampling_N&quot; : 1000, &quot;random_distribution_iteration&quot; : 20000, &quot;calculate_CIs&quot; : &quot;TRUE&quot;}]}&#39; \
https://prism.peermodelsnetwork.com/route/accept/run</code></pre>
</div>
<div id="bode" class="section level2">
<h2><span class="header-section-number">13.2</span> BODE</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>bode</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;bode&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;FEV1&quot;: 40,&quot;mMRC&quot;: 3,&quot;BMI&quot;: 22,&quot;walk&quot;: 100}]}&#39; \
https://prism.peermodelsnetwork.com/route/bode/run</code></pre>
</div>
<div id="epic" class="section level2">
<h2><span class="header-section-number">13.3</span> EPIC</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>epicR</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;epic&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
</div>
<div id="fev1" class="section level2">
<h2><span class="header-section-number">13.4</span> FEV1</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>fev1</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;fev1&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;male&quot;:1,&quot;age&quot;:70,&quot;smoker&quot;:1,&quot;FEV1&quot;:2.5,&quot;height&quot;:1.68,&quot;weight&quot;:65}]}&#39; \
https://prism.peermodelsnetwork.com/route/fev1/run
</code></pre>
</div>
<div id="cvdanderson" class="section level2">
<h2><span class="header-section-number">13.5</span> CVDAnderson</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>cvdanderson</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;cvdanderson&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;age&quot;: 33,&quot;gender&quot;: 1,&quot;Tchol&quot;: 230,&quot;ECG_LVH&quot;: 0,&quot;HDLchol&quot;: 48, &quot;SBP&quot;: 135, &quot;DBP&quot;: 88, &quot;diabetes&quot;: 1, &quot;smoker&quot;: 1, &quot;t&quot;: 10}]}&#39; \
https://prism.peermodelsnetwork.com/route/cvdanderson/run</code></pre>
</div>
<div id="chdwilson" class="section level2">
<h2><span class="header-section-number">13.6</span> CHDWilson</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>chdwilson</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;chdwilson&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;age&quot;: 55,&quot;gender&quot;: 1,&quot;TChol&quot;: 250,&quot;LDL&quot;: 120,&quot;HDL&quot;: 39, &quot;SBP&quot;: 146, &quot;DBP&quot;: 88, &quot;diabetes&quot;: 0, &quot;smoker&quot;: 1}]}&#39; \
https://prism.peermodelsnetwork.com/route/chdwilson/run</code></pre>
</div>
<div id="cfmortality" class="section level2">
<h2><span class="header-section-number">13.7</span> CFMortality</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>chdwilson</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;cfmortality&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;male&quot;: 0,&quot;age&quot;: 57,&quot;fvc&quot;: 66.7,&quot;fev1&quot;: 47.4,&quot;fev1LastYear&quot;: 80.5,&quot;bcepacia&quot;: 0,&quot;underweight&quot;: 0,&quot;nHosp&quot;: 0,&quot;pancreaticInsufficient&quot;: 1,&quot;CFRelatedDiabetes&quot;: 0,&quot;ageAtDiagnosis&quot;: 0.9}]}&#39; \
https://prism.peermodelsnetwork.com/route/cfmortality/run</code></pre>
</div>
<div id="qrisk3" class="section level2">
<h2><span class="header-section-number">13.8</span> QRISK3</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>QRISK3</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;qrisk3&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
</div>
<div id="codexcopd" class="section level2">
<h2><span class="header-section-number">13.9</span> CODEXCOPD</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>codexcopd</code> package:</p>
<pre><code>remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model(&quot;codexcopd&quot;, api_key = YOUR_API_KEY)
input &lt;- get_default_input()
results &lt;- model_run(input)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: REPLACE_WITH_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:[{&quot;age&quot;:40,&quot;charlson&quot;:8,&quot;FEV1&quot;:40,&quot;mMRC&quot;:3,&quot;exacerbation&quot;:2}]}&#39; \
https://prism.peermodelsnetwork.com/route/codexcopd/run</code></pre>
</div>
<div id="mmrcea" class="section level2">
<h2><span class="header-section-number">13.10</span> MMRCEA</h2>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example inputs provided by the modelling team:</p>
<pre><code>library(peermodels)

connect_to_model(&quot;mmrcea&quot;, api_key = YOUR_API_KEY)

input &lt;- get_default_input()

input$timeHorizon                                    &lt;- 5
input$discountRate                                   &lt;- 0.015
input$averageFamilyReferred                          &lt;- 2       
input$familyReferredHCP                              &lt;- 1     
input$adherenceIntensiveScreening                    &lt;- 0.9      
input$crcmmrDefReferredHCPIntArm	                   &lt;- 0.3   
input$crcmmrDefReferredHCPmmrbrafCompArmVCHA         &lt;-	0.3   
input$crcmmrDefReferredHCPmmrCompArmVCHA	           &lt;- 0.08  
input$crcmmrDefReferredHCPmmrbrafCompArmVIHA         &lt;- 0.08  
input$crcmmrDefReferredHCPmmrCompArmOtherHA	         &lt;- 0.08  
input$ecmmrDefReferredHCPIntArm	                     &lt;- 0.8   

model_run(input)</code></pre>
</div>
<div id="covidseir" class="section level2">
<h2><span class="header-section-number">13.11</span> COVIDSEIR</h2>
<p>We have recently deployed the Bayesian SEIR model to estimate physical-distancing effects <a href="https://doi.org/10.1101/2020.04.17.20070086">developed by Anderson et al</a> to our cloud infrastructure. The current version of the R package deployed to the PRISM server is <code>covidseir v0.0.0.9006</code>.</p>
<p>The current implementation of the <code>covidseir</code> package is experimental and has some limitations, given the computational intensity of the model. Depending on the number of <code>chains</code> and <code>iterations</code>, the <code>html</code> connection might be dropped for calls that more than a dozen minutes.
Currently, fitting the model with default parameters takes about 5 minutes. We are actively working to implement asynchronous support which would email the results back to the user when hours long model runs are requested.</p>
<p><strong>Cloud Access through R</strong></p>
<p>Users can access models on the Peer Models Network using the <code>peermodels</code> R package, available on <a href="https://github.com/resplab/peermodels">GitHub</a>. The following code snippet illustrates how you can run the model for example patient provided in the <code>covidseir</code> package:</p>
<pre><code>library(peermodels)
connect_to_model(&quot;covidseir&quot;, api_key = YOUR_API_KEY, bypass_router = T)
input &lt;- get_default_input()
names(input)
input$daily_cases
results &lt;- model_run(input)
names(results)
draw_plots()</code></pre>
<p>The same workflow can be used to fit and run the model based on custom data. For example, the code snippet below, automatically downloads latest COVID-19 case numbers for British Columbia, and reruns the simulation using different assumptions.</p>
<pre><code>library(stringr)
library(dplyr)
library(tidyr)
library(readr)
library(lubridate)
library(peermodels)

url &lt;- &quot;https://docs.google.com/spreadsheets/d/1ad7-09_Jn6AxsdkVPE33T-iLfGpPRmd3piXQqFiVeas/export?&amp;format=csv&quot;

CanadaCases &lt;- read_csv(url)

covidCases &lt;-  CanadaCases %&gt;% rename (name = &quot;prname&quot;) %&gt;% rename (Cases = &quot;numconf&quot;)  %&gt;% mutate(date=dmy(date)) %&gt;%
  filter (name!=&quot;Canada&quot;) %&gt;% filter (date!=today())

bcCases &lt;- covidCases %&gt;% filter (name == &quot;British Columbia&quot;)

connect_to_model(&quot;covidseir&quot;, api_key = &quot;YDbxcnNHmf4XoteSmCFHKx&quot;, bypass_router = T)

input &lt;- get_default_input()
first &lt;- length(bcCases$numtoday)-42+1
last &lt;- length(bcCases$numtoday)
input$daily_cases &lt;- bcCases$numtoday[first:last]

# Example assumed sampling fractions of positive cases:
s1 &lt;- c(rep(0.1, 13), rep(0.2, length(input$daily_cases) - 13))

samp_frac_seg &lt;- c(rep(1, 13), rep(2, length(input$daily_cases) - 13))
s2 &lt;- rep(0.07, length(input$daily_cases)) # Assuming 7\% of positive individuals are hospitalized

input$samp_frac_fixed &lt;- rep(0.1, length(input$daily_cases))

input$fit_iter &lt;- 100
input$chains &lt;- 1

input$f_fixed &lt;- rep(0.1, 90)
results &lt;- model_run(input)

draw_plots()</code></pre>
<p><strong>Cloud Access through Python</strong></p>
<p>Users can use Python to access <code>covidseir</code> model on the cloud. The simple code snippet below runs the model with default inputs.</p>
<pre><code>import json
import requests
url = &#39;http://model-covidseir.cp.prism-ubc.linaralabs.com/ocpu/library/covidseirPrism/R/gateway/json&#39;
headers = {&#39;x-prism-auth-user&#39;: &#39;YOUR_API_KEY&#39;}
default_input = requests.post(url, headers=headers,json = {&quot;func&quot;:[&quot;get_default_input&quot;]})
# json_default_input = json.loads(default_input.json()[0]) # OR:
json_default_input = json.loads(json.loads(default_input.text)[0])
response = requests.post(url, headers=headers,json = {&quot;func&quot;:[&quot;prism_model_run&quot;], &quot;model_input&quot;:json_default_input})
results = json.loads(response.text)</code></pre>
<p><strong>Cloud Access through Linux Bash</strong></p>
<p>In Ubuntu, you can call the API with <code>curl</code>:</p>
<pre><code>curl \
-X POST \
-H &quot;x-prism-auth-user: YOUR_API_KEY&quot; \
-H &quot;Content-Type: application/json&quot; \
-d &#39;{&quot;func&quot;:[&quot;prism_model_run&quot;],&quot;model_input&quot;:{&quot;daily_cases&quot;:[0,0,1,3,1,8,0,6,5,0,7,7,18,9,22,38,53,45,40,77,76,48,67,78,42,66,67,92,16,70,43,53,55,53,29,26,37,25,45,34,40,35],&quot;obs_model&quot;:[&quot;NB2&quot;,&quot;Poisson&quot;],&quot;fit_forecast_days&quot;:[0],&quot;time_increment&quot;:[0.25],&quot;samp_frac_fixed&quot;:[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2],&quot;samp_frac_type&quot;:[&quot;fixed&quot;,&quot;estimated&quot;,&quot;rw&quot;,&quot;segmented&quot;],&quot;samp_frac_seg&quot;:{},&quot;days_back&quot;:[45],&quot;R0_prior&quot;:[0.9555,0.2],&quot;phi_prior&quot;:[1],&quot;f_prior&quot;:[0.4,0.2],&quot;e_prior&quot;:[0.8,0.05],&quot;samp_frac_prior&quot;:[0.4,0.2],&quot;start_decline_prior&quot;:[2.7081,0.05],&quot;end_decline_prior&quot;:[3.091,0.05],&quot;f_ramp_rate&quot;:[0],&quot;rw_sigma&quot;:[0.1],&quot;seed&quot;:[42],&quot;chains&quot;:[1],&quot;fit_iter&quot;:[100],&quot;N_pop&quot;:[5100000],&quot;pars&quot;:{&quot;D&quot;:[5],&quot;k1&quot;:[0.2],&quot;k2&quot;:[1],&quot;q&quot;:[0.05],&quot;ud&quot;:[0.1],&quot;ur&quot;:[0.02],&quot;f0&quot;:[1]},&quot;i0_prior&quot;:[2.0794,1],&quot;state_0&quot;:{&quot;E1_frac&quot;:[0.4],&quot;E2_frac&quot;:[0.1],&quot;I_frac&quot;:[0.5],&quot;Q_num&quot;:[0],&quot;R_num&quot;:[0],&quot;E1d_frac&quot;:[0.4],&quot;E2d_frac&quot;:[0.1],&quot;Id_frac&quot;:[0.5],&quot;Qd_num&quot;:[0],&quot;Rd_num&quot;:[0]},&quot;save_state_predictions&quot;:[false],&quot;delay_scale&quot;:[9.85],&quot;delay_shape&quot;:[1.73],&quot;ode_control&quot;:[1e-07,1e-06,1000000],&quot;project_forecast_days&quot;:[100],&quot;f_fixed_start&quot;:[53],&quot;f_fixed&quot;:[0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2],&quot;forecast_iter&quot;:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],&quot;return_states&quot;:[false],&quot;imported_cases&quot;:[0],&quot;imported_window&quot;:[1],&quot;f_seg&quot;:[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]} 
} &#39; \
http://model-covidseir.cp.prism-ubc.linaralabs.com/ocpu/library/covidseirPrism/R/gateway/json</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="qrisk3.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["prismGuide.pdf", "prismGuide.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
