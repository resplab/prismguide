% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Peer Models Network API Guide},
  pdfauthor={Amin Adibi, Stephanie Harvard, Mohsen Sadatsafavi},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Peer Models Network API Guide}
\author{Amin Adibi, Stephanie Harvard, Mohsen Sadatsafavi}
\date{2020-07-02}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter{Introduction}\label{introduction}}

\href{https://www.peermodelsnetwork.com/}{Peer Models Network} is an initiative to make models for healthcare decision-making accessible, transparent and interpretable to all British Columbians. With support from the Canada Foundation for Innovation, BC SUPPORT Unit and BC Academic Health Science Network, the Peer Models Network (PMN) aims to increase engagement between the modelling community and policymakers, interdisciplinary scholars, patients, journalists, and other members of the public.

The PMN centres around a software infrastructure called the Programmable Interface for Statistical and Simulation Models (PRISM). PRISM hosts models on the cloud and provides standard Application Programming Interfaces (APIs) that allows users of different levels of technical backgrounds to interact with models hosted on a cloud. Users can submit queries to cloud-hosted models through a multitude of software platforms, including Microsoft Excel, R, Python, bash scripts, Javascript and custom web apps. This enables direct access to users who lack either the software or hardware infrastructure or the technical expertise to set up models on their own devices. It also enables more technical users to integrate modes with other pieces of softwar

In its current implementation, PRISM can hosts models that are developed in R, including those that use \texttt{Cpp} and \texttt{STAN}.

Synchronous APIs calls are currently implemented and support for asynchronous calls that are required by extra long processing times is under active development.

\hypertarget{accept}{%
\chapter{ACCEPT}\label{accept}}

\begin{longtable}[]{@{}ll@{}}
\toprule
Field & Value\tabularnewline
\midrule
\endhead
Model Name & Acute COPD Exacerbation Prediction Tool (ACCEPT)\tabularnewline
Modelling Team & \href{http://resp.core.ubc.ca}{RESP}\tabularnewline
Publication & \href{https://doi.org/10.1016/S2213-2600(19)30397-2}{doi:10.1016/S2213-2600(19)30397-2}\tabularnewline
Purpose & Predict probability, rate, and severity of COPD exacerbations\tabularnewline
Video & \href{https://www.peermodelsnetwork.com/educational-videos?wix-vod-video-id=679cbb410686401193779a2931731c56\&wix-vod-comp-id=comp-k8q9lys1}{The ACCEPT Model in 90 Seconds}\tabularnewline
Interviews & \href{https://www.peermodelsnetwork.com/post/amin-adibi-on-the-accept-model-for-copd-why-and-how}{Amin Adibi on the ACCEPT Model for COPD: Why and How}\tabularnewline
Media & \href{https://doi.org/10.1016/S2213-2600(20)30049-7}{COPD exacerbations: finally, a more than ACCEPTable risk score}\tabularnewline
Web App & \href{http://resp.core.ubc.ca/ipress/accept}{ACCEPT web App}\tabularnewline
R Package & \href{https://cran.r-project.org/package=accept}{accept}\tabularnewline
Excel Sheet & \href{https://drive.google.com/uc?export=download\&id=1NNE7pKBVP939tly-6JISaVw-y33m8y28}{PC Version}\tabularnewline
API User Guide & \href{https://resplab.github.io/prismguide/api-users-guide.html\#accept-api}{Link}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{bode}{%
\chapter{BODE}\label{bode}}

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.45\columnwidth}\raggedright
Field\strut
\end{minipage} & \begin{minipage}[b]{0.49\columnwidth}\raggedright
Value\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Model Name\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
The Body-Mass Index, Airflow Obstruction, Dyspnea, and Exercise Capacity Index\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Modelling Team\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Celli et al.\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Publication\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://doi.org/10.1056/NEJMoa021322}{10.1056/NEJMoa021322}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Outcome\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Mortality Risk\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Excel Sheet\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://drive.google.com/uc?export=download\&id=14H_4NQzY4xqsRDu3ZnVzcJa8ym66aFyb}{PC Version}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
R Package\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://github.com/resplab/bode}{bode}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
API User Guide\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://resplab.github.io/prismguide/api-users-guide.html\#bode-api}{Link}\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{cfmortality}{%
\chapter{CFMortality}\label{cfmortality}}

\begin{longtable}[]{@{}ll@{}}
\toprule
Field & Value\tabularnewline
\midrule
\endhead
Model Name & Mortality prediction models in cystic fibrosis\tabularnewline
Modelling Team & Stanojevic et al.\tabularnewline
Publication & \href{https://doi.org/10.1183/13993003.00224-2019}{10.1183/13993003.00224-2019}\tabularnewline
Outcome & Mortality Risk\tabularnewline
Excel Sheet & \href{https://drive.google.com/uc?export=download\&id=17cyol2PEHT5R3JMDPNNZ6khDQ6ICVmkq}{PC Version}\tabularnewline
R Package & \href{https://cran.r-project.org/package=cfmortality}{cfmortality}\tabularnewline
API User Guide & \href{https://resplab.github.io/prismguide/api-users-guide.html\#cfmortality-api}{Link}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{chdwilson}{%
\chapter{CHDWilson}\label{chdwilson}}

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.45\columnwidth}\raggedright
Field\strut
\end{minipage} & \begin{minipage}[b]{0.49\columnwidth}\raggedright
Value\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Model Name\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Prediction of Coronary Heart Disease Using Risk Factor Categories\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Modelling Team\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Wilson et al.\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Publication\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://doi.org/10.1161/01.CIR.97.18.1837}{10.1161/01.CIR.97.18.1837}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Outcome\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Coronary Heart Disease\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Excel Sheet\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://drive.google.com/uc?export=download\&id=18RcG1yHeobxNw7T7m_dnF_5VDIz1ty--}{PC Version}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
R Package\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://github.com/resplab/chdwilson}{chdwilson}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
API User Guide\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://resplab.github.io/prismguide/api-users-guide.html\#chdwilson-api}{Link}\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{codexcopd}{%
\chapter{CODEXCOPD}\label{codexcopd}}

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.45\columnwidth}\raggedright
Field\strut
\end{minipage} & \begin{minipage}[b]{0.49\columnwidth}\raggedright
Value\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Model Name\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
The CODEX (comorbidity, obstruction, dyspnea, and previous severe exacerbations) Index\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Modelling Team\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Almagro et al.\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Publication\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://doi.org/10.1378/chest.13-1328}{10.1378/chest.13-1328}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Outcome\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Survival and readmission at both 3 months and 1 year after hospital discharge for a COPD exacerbation\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
R Package\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://github.com/resplab/codexcopd}{codexcopd}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
API User Guide\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://resplab.github.io/prismguide/api-users-guide.html\#codexcopd-api}{Link}\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{covidseir}{%
\chapter{COVIDSEIR}\label{covidseir}}

\begin{longtable}[]{@{}ll@{}}
\toprule
Field & Value\tabularnewline
\midrule
\endhead
Model Name & Bayesian SEIR model to estimate physical-distancing effects\tabularnewline
Modelling Team & Anderson et al.\tabularnewline
Publication & \href{https://doi.org/10.1101/2020.04.17.20070086}{10.1101/2020.04.17.20070086}\tabularnewline
Outcome & COVID-19 Cases\tabularnewline
R Package & \href{https://github.com/seananderson/covidseir}{covidseir}\tabularnewline
API User Guide & \href{https://resplab.github.io/prismguide/api-users-guide.html\#covidseir-api-experimental}{Link}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{cvdanderson}{%
\chapter{CVDAnderson}\label{cvdanderson}}

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.45\columnwidth}\raggedright
Field\strut
\end{minipage} & \begin{minipage}[b]{0.49\columnwidth}\raggedright
Value\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Model Name\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Prediction of Coronary Heart Disease Using Risk Factor Categories\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Modelling Team\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Anderson et al.\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Publication\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://doi.org/10.1016/0002-8703(91)90861-B}{10.1016/0002-8703(91)90861-B}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Outcome\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
CHD, MI, CHD Mortality, Stroke, CVD, CVD Mortalitye\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
R Package\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://github.com/resplab/cvdanderson}{cvdanderson}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
API User Guide\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://resplab.github.io/prismguide/api-users-guide.html\#cvdanderson-api}{Link}\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{epic}{%
\chapter{EPIC}\label{epic}}

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.45\columnwidth}\raggedright
Field\strut
\end{minipage} & \begin{minipage}[b]{0.49\columnwidth}\raggedright
Value\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Model Name\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Evaluation Platform in COPD (EPIC)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Modelling Team\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{http://resp.core.ubc.ca}{RESP}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Publication\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://doi.org/10.1177\%2F0272989X18824098}{doi:10.1177\%2F0272989X18824098}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Outcome\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Patient-level outcomes, as well as mortality, prevalence, QALYs, costs, etc.\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Video\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://www.peermodelsnetwork.com/educational-videos?wix-vod-video-id=b394fa69ae404fdeb2ceae17f308fbea\&wix-vod-comp-id=comp-k8q9lys1}{The EPIC Model in 2 Minutes}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Interviews\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://www.peermodelsnetwork.com/post/interview-with-mohsen-sadatsafavi}{Mohsen Sadatsafavi on the EPIC Model}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
R Package\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://github.com/resplab/epicR}{epicR}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Excel Sheet\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://drive.google.com/uc?export=download\&id=15yY_O7wVgoEbaHNLDBjfN2PqnenB6WWa}{PC Version}\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
API User Guide\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://resplab.github.io/prismguide/api-users-guide.html\#epic-api}{Link}\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{fev1}{%
\chapter{FEV1}\label{fev1}}

\begin{longtable}[]{@{}ll@{}}
\toprule
Field & Value\tabularnewline
\midrule
\endhead
Model Name & Individualized prediction of lung-function decline in COPD\tabularnewline
Modelling Team & \href{http://resp.core.ubc.ca}{RESP}\tabularnewline
Publication & \href{https://doi.org/10.1503/cmaj.151483}{doi:10.1503/cmaj.151483}\tabularnewline
Outcome & Lung function over next 11 years\tabularnewline
Web App & \href{http://resp.core.ubc.ca/ipress/FEV1Pred}{FEV1 web App}\tabularnewline
Excel Sheet & \href{https://drive.google.com/uc?export=download\&id=1--OGtwrKHuQeUqaYMQ3CISvnTODQbF_I}{PC Version}\tabularnewline
R Package & \href{https://github.com/resplab/fev1}{fev1}\tabularnewline
API User Guide & \href{https://resplab.github.io/prismguide/api-users-guide.html\#fev1-api}{Link}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{mmrcea}{%
\chapter{MMRCEA}\label{mmrcea}}

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.45\columnwidth}\raggedright
Field\strut
\end{minipage} & \begin{minipage}[b]{0.49\columnwidth}\raggedright
Value\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Model Name\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Cost-effectiveness evaluation of province-wide universal mismatch repair (MMR) reflex testing for lynch syndrome (LS) in British Columbia\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Modelling Team\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Centre for Clinical Epidemiology \& Evaluation (C2E2)\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Outcome\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Costs, QALYs and life-years for the prevention and management of colorectal and endometrial cancers patients and their families\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
Excel Sheet\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
Pending\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.45\columnwidth}\raggedright
API User Guide\strut
\end{minipage} & \begin{minipage}[t]{0.49\columnwidth}\raggedright
\href{https://resplab.github.io/prismguide/api-users-guide.html\#mmrcea-api}{Link}\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{qrisk3}{%
\chapter{QRISK3}\label{qrisk3}}

\begin{longtable}[]{@{}ll@{}}
\toprule
Field & Value\tabularnewline
\midrule
\endhead
Model Name & 10-Year Cardiovascular Disease Risk Calculator\tabularnewline
Modelling Team & Hippisley-Cox et al.\tabularnewline
Publication & \href{https://doi.org/10.1136/bmj.j2099}{10.1136/bmj.j2099}\tabularnewline
Outcome & 10-yr risk of heart attack/stroke\tabularnewline
R Package & \href{https://cran.r-project.org/package=QRISK3}{QRISK3}\tabularnewline
API User Guide & \href{https://resplab.github.io/prismguide/api-users-guide.html\#qrisk3-api}{Link}\tabularnewline
\bottomrule
\end{longtable}

\hypertarget{api-users-guide}{%
\chapter{API Users' Guide}\label{api-users-guide}}

\hypertarget{accept-api}{%
\section{ACCEPT API}\label{accept-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patients provided in the \texttt{accept} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("accept", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Python}

\begin{verbatim}
import json
import requests
url = 'https://prism.peermodelsnetwork.com/route/accept/run'
headers = {'x-prism-auth-user': YOUR_API_KEY}
model_run = requests.post(url, headers=headers,
json = {"func":["prism_model_run"],"model_input":[{"ID": "10001","male": 1,"age": 57,"smoker": 0,"oxygen": 0,"statin": 0,"LAMA": 1,"LABA": 1,"ICS": 1,"FEV1": 51,"BMI": 18,"SGRQ": 63,"LastYrExacCount": 2,"LastYrSevExacCount": 1,"randomized_azithromycin": 0,"randomized_statin": 0,"randomized_LAMA": 0,"randomized_LABA": 0,"randomized_ICS": 0, "random_sampling_N" : 1000, "random_distribution_iteration" : 20000, "calculate_CIs" : "TRUE"}]})
print(model_run)
results = json.loads(model_run.text)
print(results)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"ID": "10001","male": 1,"age": 57,"smoker": 0,"oxygen": 0,"statin": 0,"LAMA": 1,"LABA": 1,"ICS": 1,"FEV1": 51,"BMI": 18,"SGRQ": 63,"LastYrExacCount": 2,"LastYrSevExacCount": 1,"randomized_azithromycin": 0,"randomized_statin": 0,"randomized_LAMA": 0,"randomized_LABA": 0,"randomized_ICS": 0, "random_sampling_N" : 1000, "random_distribution_iteration" : 20000, "calculate_CIs" : "TRUE"}]}' \
https://prism.peermodelsnetwork.com/route/accept/run
\end{verbatim}

\hypertarget{bode-api}{%
\section{BODE API}\label{bode-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{bode} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("bode", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"FEV1": 40,"mMRC": 3,"BMI": 22,"walk": 100}]}' \
https://prism.peermodelsnetwork.com/route/bode/run
\end{verbatim}

\hypertarget{epic-api}{%
\section{EPIC API}\label{epic-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{epicR} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("epic", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\hypertarget{fev1-api}{%
\section{FEV1 API}\label{fev1-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{fev1} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("fev1", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"male":1,"age":70,"smoker":1,"FEV1":2.5,"height":1.68,"weight":65}]}' \
https://prism.peermodelsnetwork.com/route/fev1/run
\end{verbatim}

\hypertarget{cvdanderson-api}{%
\section{CVDAnderson API}\label{cvdanderson-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{cvdanderson} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("cvdanderson", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"age": 33,"gender": 1,"Tchol": 230,"ECG_LVH": 0,"HDLchol": 48, "SBP": 135, "DBP": 88, "diabetes": 1, "smoker": 1, "t": 10}]}' \
https://prism.peermodelsnetwork.com/route/cvdanderson/run
\end{verbatim}

\hypertarget{chdwilson-api}{%
\section{CHDWilson API}\label{chdwilson-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{chdwilson} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("chdwilson", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"age": 55,"gender": 1,"TChol": 250,"LDL": 120,"HDL": 39, "SBP": 146, "DBP": 88, "diabetes": 0, "smoker": 1}]}' \
https://prism.peermodelsnetwork.com/route/chdwilson/run
\end{verbatim}

\hypertarget{cfmortality-api}{%
\section{CFMortality API}\label{cfmortality-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{chdwilson} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("cfmortality", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"male": 0,"age": 57,"fvc": 66.7,"fev1": 47.4,"fev1LastYear": 80.5,"bcepacia": 0,"underweight": 0,"nHosp": 0,"pancreaticInsufficient": 1,"CFRelatedDiabetes": 0,"ageAtDiagnosis": 0.9}]}' \
https://prism.peermodelsnetwork.com/route/cfmortality/run
\end{verbatim}

\hypertarget{qrisk3-api}{%
\section{QRISK3 API}\label{qrisk3-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{QRISK3} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("qrisk3", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\hypertarget{codexcopd-api}{%
\section{CODEXCOPD API}\label{codexcopd-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{codexcopd} package:

\begin{verbatim}
remotes::install_github (resplab/peermodels)
library(peermodels)
connect_to_model("codexcopd", api_key = YOUR_API_KEY)
input <- get_default_input()
results <- model_run(input)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: REPLACE_WITH_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":[{"age":40,"charlson":8,"FEV1":40,"mMRC":3,"exacerbation":2}]}' \
https://prism.peermodelsnetwork.com/route/codexcopd/run
\end{verbatim}

\hypertarget{mmrcea-api}{%
\section{MMRCEA API}\label{mmrcea-api}}

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example inputs provided by the modelling team:

\begin{verbatim}
library(peermodels)

connect_to_model("mmrcea", api_key = YOUR_API_KEY)

input <- get_default_input()

input$timeHorizon                                    <- 5
input$discountRate                                   <- 0.015
input$averageFamilyReferred                          <- 2       
input$familyReferredHCP                              <- 1     
input$adherenceIntensiveScreening                    <- 0.9      
input$crcmmrDefReferredHCPIntArm	                   <- 0.3   
input$crcmmrDefReferredHCPmmrbrafCompArmVCHA         <-	0.3   
input$crcmmrDefReferredHCPmmrCompArmVCHA	           <- 0.08  
input$crcmmrDefReferredHCPmmrbrafCompArmVIHA         <- 0.08  
input$crcmmrDefReferredHCPmmrCompArmOtherHA	         <- 0.08  
input$ecmmrDefReferredHCPIntArm	                     <- 0.8   

model_run(input)
\end{verbatim}

\hypertarget{covidseir-api-experimental}{%
\section{COVIDSEIR API (experimental)}\label{covidseir-api-experimental}}

We have recently deployed the Bayesian SEIR model to estimate physical-distancing effects \href{https://doi.org/10.1101/2020.04.17.20070086}{developed by Anderson et al} to our cloud infrastructure. The current version of the R package deployed to the PRISM server is \texttt{covidseir\ v0.0.0.9006}.

The current implementation of the \texttt{covidseir} package is experimental and has some limitations, given the computational intensity of the model. Depending on the number of \texttt{chains} and \texttt{iterations}, the \texttt{html} connection might be dropped for calls that more than a dozen minutes.
Currently, fitting the model with default parameters takes about 5 minutes. We are actively working to implement asynchronous support which would email the results back to the user when hours long model runs are requested.

\textbf{Cloud Access through R}

Users can access models on the Peer Models Network using the \texttt{peermodels} R package, available on \href{https://github.com/resplab/peermodels}{GitHub}. The following code snippet illustrates how you can run the model for example patient provided in the \texttt{covidseir} package:

\begin{verbatim}
library(peermodels)
connect_to_model("covidseir", api_key = YOUR_API_KEY, bypass_router = T)
input <- get_default_input()
names(input)
input$daily_cases
results <- model_run(input)
names(results)
draw_plots()
\end{verbatim}

The same workflow can be used to fit and run the model based on custom data. For example, the code snippet below, automatically downloads latest COVID-19 case numbers for British Columbia, and reruns the simulation using different assumptions.

\begin{verbatim}
library(stringr)
library(dplyr)
library(tidyr)
library(readr)
library(lubridate)
library(peermodels)

url <- "https://docs.google.com/spreadsheets/d/1ad7-09_Jn6AxsdkVPE33T-iLfGpPRmd3piXQqFiVeas/export?&format=csv"

CanadaCases <- read_csv(url)

covidCases <-  CanadaCases %>% rename (name = "prname") %>% rename (Cases = "numconf")  %>% mutate(date=dmy(date)) %>%
  filter (name!="Canada") %>% filter (date!=today())

bcCases <- covidCases %>% filter (name == "British Columbia")

connect_to_model("covidseir", api_key = "YDbxcnNHmf4XoteSmCFHKx", bypass_router = T)

input <- get_default_input()
first <- length(bcCases$numtoday)-42+1
last <- length(bcCases$numtoday)
input$daily_cases <- bcCases$numtoday[first:last]

# Example assumed sampling fractions of positive cases:
s1 <- c(rep(0.1, 13), rep(0.2, length(input$daily_cases) - 13))

samp_frac_seg <- c(rep(1, 13), rep(2, length(input$daily_cases) - 13))
s2 <- rep(0.07, length(input$daily_cases)) # Assuming 7\% of positive individuals are hospitalized

input$samp_frac_fixed <- rep(0.1, length(input$daily_cases))

input$fit_iter <- 100
input$chains <- 1

input$f_fixed <- rep(0.1, 90)
results <- model_run(input)

draw_plots()
\end{verbatim}

\textbf{Cloud Access through Python}

Users can use Python to access \texttt{covidseir} model on the cloud. The simple code snippet below runs the model with default inputs.

\begin{verbatim}
import json
import requests
url = 'http://model-covidseir.cp.prism-ubc.linaralabs.com/ocpu/library/covidseirPrism/R/gateway/json'
headers = {'x-prism-auth-user': 'YOUR_API_KEY'}
default_input = requests.post(url, headers=headers,json = {"func":["get_default_input"]})
# json_default_input = json.loads(default_input.json()[0]) # OR:
json_default_input = json.loads(json.loads(default_input.text)[0])
response = requests.post(url, headers=headers,json = {"func":["prism_model_run"], "model_input":json_default_input})
results = json.loads(response.text)
\end{verbatim}

\textbf{Cloud Access through Linux Bash}

In Ubuntu, you can call the API with \texttt{curl}:

\begin{verbatim}
curl \
-X POST \
-H "x-prism-auth-user: YOUR_API_KEY" \
-H "Content-Type: application/json" \
-d '{"func":["prism_model_run"],"model_input":{"daily_cases":[0,0,1,3,1,8,0,6,5,0,7,7,18,9,22,38,53,45,40,77,76,48,67,78,42,66,67,92,16,70,43,53,55,53,29,26,37,25,45,34,40,35],"obs_model":["NB2","Poisson"],"fit_forecast_days":[0],"time_increment":[0.25],"samp_frac_fixed":[0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2],"samp_frac_type":["fixed","estimated","rw","segmented"],"samp_frac_seg":{},"days_back":[45],"R0_prior":[0.9555,0.2],"phi_prior":[1],"f_prior":[0.4,0.2],"e_prior":[0.8,0.05],"samp_frac_prior":[0.4,0.2],"start_decline_prior":[2.7081,0.05],"end_decline_prior":[3.091,0.05],"f_ramp_rate":[0],"rw_sigma":[0.1],"seed":[42],"chains":[1],"fit_iter":[100],"N_pop":[5100000],"pars":{"D":[5],"k1":[0.2],"k2":[1],"q":[0.05],"ud":[0.1],"ur":[0.02],"f0":[1]},"i0_prior":[2.0794,1],"state_0":{"E1_frac":[0.4],"E2_frac":[0.1],"I_frac":[0.5],"Q_num":[0],"R_num":[0],"E1d_frac":[0.4],"E2d_frac":[0.1],"Id_frac":[0.5],"Qd_num":[0],"Rd_num":[0]},"save_state_predictions":[false],"delay_scale":[9.85],"delay_shape":[1.73],"ode_control":[1e-07,1e-06,1000000],"project_forecast_days":[100],"f_fixed_start":[53],"f_fixed":[0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.7,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2],"forecast_iter":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],"return_states":[false],"imported_cases":[0],"imported_window":[1],"f_seg":[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]} 
} ' \
http://model-covidseir.cp.prism-ubc.linaralabs.com/ocpu/library/covidseirPrism/R/gateway/json
\end{verbatim}

\end{document}
